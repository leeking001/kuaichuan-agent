<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¿«ä¼ å·Agentç‰ˆ</title>
    <style>
        /* --- 1. æ ¸å¿ƒå˜é‡ (Material 3 é£æ ¼) --- */
        :root {
            /* æµ…è‰²æ¨¡å¼ */
            --bg-app: #F0F4F9;
            --bg-card: #FFFFFF;
            --text-primary: #1F1F1F;
            --text-secondary: #444746;
            --text-tertiary: #76777A;
            --primary: #0B57D0;
            --primary-bg: #D3E3FD;
            --outline: #E0E3E1;
            --surface-variant: #F0F4F9;
            --warning-bg: #FFEBEE;
            --warning-text: #C62828;
            --success: #1E8E3E;
            --header-height: 64px;
            --radius: 16px;
            --shadow: 0 2px 6px rgba(0,0,0,0.05);
        }

        [data-theme="dark"] {
            /* æ·±è‰²æ¨¡å¼ */
            --bg-app: #131314;
            --bg-card: #1E1F20;
            --text-primary: #E3E3E3;
            --text-secondary: #C4C7C5;
            --text-tertiary: #8E918F;
            --primary: #A8C7FA;
            --primary-bg: #0842A0;
            --outline: #444746;
            --surface-variant: #282A2C;
            --warning-bg: #3E1C1C;
            --warning-text: #FFB4AB;
            --success: #81C995;
            --shadow: 0 2px 6px rgba(0,0,0,0.4);
        }

        /* --- 2. å…¨å±€é‡ç½® --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-app);
            color: var(--text-primary);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background 0.3s, color 0.3s;
        }
        a { text-decoration: none; color: inherit; }
        .icon { width: 20px; height: 20px; fill: currentColor; vertical-align: middle; }

        /* --- 3. æ–°æ‰‹å¼•å¯¼ Tooltip --- */
        .help-icon {
            display: inline-flex; align-items: center; justify-content: center;
            width: 16px; height: 16px; border-radius: 50%;
            background: var(--outline); color: var(--text-secondary);
            font-size: 10px; cursor: help; margin-left: 6px;
            position: relative;
        }
        .help-icon:hover::after {
            content: attr(data-tip);
            position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: #fff; padding: 6px 10px;
            border-radius: 6px; font-size: 12px; white-space: pre-wrap; width: max-content; max-width: 200px;
            z-index: 100; pointer-events: none;
        }

        /* --- 4. é¡¶éƒ¨å¯¼èˆª --- */
        .header {
            height: var(--header-height);
            background: var(--bg-card);
            border-bottom: 1px solid var(--outline);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 24px; flex-shrink: 0;
        }
        .logo { font-size: 18px; font-weight: 600; color: var(--text-primary); display: flex; align-items: center; gap: 10px; }
        .header-actions { display: flex; align-items: center; gap: 16px; }
        .btn-text { font-size: 14px; color: var(--text-secondary); padding: 6px 12px; border-radius: 8px; transition: background 0.2s; }
        .btn-text:hover { background: var(--surface-variant); color: var(--primary); }
        .theme-toggle { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--text-secondary); background: var(--surface-variant); }

        /* --- 5. ä¸»å¸ƒå±€ --- */
        .main-layout {
            flex: 1; padding: 20px;
            display: grid; grid-template-columns: 320px 1fr 320px;
            gap: 20px; overflow-y: auto;
        }

        /* é€šç”¨å¡ç‰‡ */
        .agent-card {
            background: var(--bg-card); border-radius: var(--radius);
            border: 1px solid var(--outline); display: flex; flex-direction: column;
            overflow: hidden; box-shadow: var(--shadow);
        }
        .agent-header {
            padding: 16px 20px; border-bottom: 1px solid var(--outline);
            font-weight: 600; font-size: 15px; display: flex; align-items: center; gap: 8px;
            background: var(--bg-card);
        }
        .agent-body { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 16px; }

        /* --- æ¨¡å— 1: æ¯æ—¥æ’­æŠ¥ (å¢å¼ºç‰ˆ) --- */
        .metric-row { display: flex; justify-content: space-between; margin-bottom: 16px; }
        .metric-box { text-align: center; flex: 1; }
        .metric-val { font-size: 18px; font-weight: 700; }
        .metric-lbl { font-size: 12px; color: var(--text-secondary); }
        
        /* å®¡æ ¸å»ºè®® */
        .audit-box {
            background: var(--warning-bg); border-radius: 8px; padding: 12px;
            border: 1px solid rgba(0,0,0,0.05);
        }
        .audit-title { font-size: 13px; font-weight: 600; color: var(--warning-text); margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
        .audit-content { font-size: 12px; color: var(--text-primary); line-height: 1.4; }

        /* æ¨èåˆ—è¡¨ */
        .rec-list { display: flex; flex-direction: column; gap: 10px; border-top: 1px solid var(--outline); padding-top: 16px; }
        .rec-item { display: flex; gap: 10px; cursor: pointer; }
        .rec-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; height: fit-content; white-space: nowrap; }
        .tag-notice { background: #E3F2FD; color: #1565C0; }
        .tag-course { background: #F3E5F5; color: #7B1FA2; }
        .tag-activity { background: #E8F5E9; color: #2E7D32; }
        .rec-text { font-size: 13px; line-height: 1.4; color: var(--text-primary); }
        .rec-text:hover { color: var(--primary); text-decoration: underline; }

        /* --- æ¨¡å— 2: å†…å®¹åˆ›ä½œ (å…¨æµç¨‹æ¨¡æ‹Ÿ) --- */
        .guide-view { display: flex; flex-direction: column; gap: 20px; height: 100%; justify-content: center; }
        .type-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .type-card {
            border: 1px solid var(--outline); border-radius: 12px; padding: 24px;
            text-align: center; cursor: pointer; transition: all 0.2s; background: var(--surface-variant);
        }
        .type-card:hover { border-color: var(--primary); background: var(--bg-card); box-shadow: var(--shadow); }
        
        .chat-view { display: none; flex-direction: column; height: 100%; }
        .chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px; }
        .msg { display: flex; gap: 12px; max-width: 90%; }
        .msg.user { align-self: flex-end; flex-direction: row-reverse; }
        .avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--surface-variant); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .bubble { padding: 12px 16px; border-radius: 12px; font-size: 14px; line-height: 1.6; background: var(--surface-variant); }
        .msg.user .bubble { background: var(--primary); color: #fff; }
        
        /* ç”Ÿæˆç»“æœå¡ç‰‡ */
        .result-card { border: 1px solid var(--outline); border-radius: 12px; overflow: hidden; background: var(--bg-card); margin-top: 8px; }
        .result-preview { height: 120px; background: #eee; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); }
        .result-info { padding: 12px; }
        .result-title { font-weight: 600; margin-bottom: 4px; }
        .publish-btn {
            width: 100%; padding: 8px; background: var(--primary); color: #fff;
            border: none; border-radius: 8px; margin-top: 10px; cursor: pointer;
        }
        .publish-btn:disabled { background: var(--success); cursor: default; }

        .input-bar { padding: 16px; border-top: 1px solid var(--outline); display: flex; gap: 10px; }
        .main-input { flex: 1; padding: 10px 16px; border-radius: 24px; border: 1px solid var(--outline); background: var(--bg-card); color: var(--text-primary); outline: none; }
        .send-btn { width: 40px; height: 40px; border-radius: 50%; background: var(--primary); color: #fff; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* --- æ¨¡å— 3: è®¤è¯/è´¦å· (å˜å½¢) --- */
        /* çŠ¶æ€A: è®¤è¯åŠ©æ‰‹ */
        .auth-view { text-align: center; padding: 20px 0; }
        .upload-box {
            border: 2px dashed var(--outline); border-radius: 12px; padding: 30px 20px;
            margin: 20px 0; cursor: pointer; color: var(--text-secondary);
        }
        .upload-box:hover { border-color: var(--primary); color: var(--primary); }
        
        /* çŠ¶æ€B: è´¦å·ä¸­å¿ƒ (æ— Header) */
        .account-view { display: none; flex-direction: column; gap: 16px; height: 100%; }
        .profile-card { display: flex; align-items: center; gap: 16px; }
        .profile-img { width: 60px; height: 60px; border-radius: 50%; background: #ccc; }
        .health-score-box {
            background: var(--surface-variant); padding: 16px; border-radius: 12px;
            text-align: center; display: flex; justify-content: space-around;
        }
        .score-val { font-size: 24px; font-weight: 700; color: var(--success); }

        /* --- æ¨¡å— 4: å®¢æœ --- */
        .preset-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px; }
        .tag-chip { font-size: 12px; padding: 6px 12px; border-radius: 16px; background: var(--surface-variant); color: var(--text-secondary); cursor: pointer; }
        .tag-chip:hover { background: var(--primary-bg); color: var(--primary); }
        .cs-chat-box { flex: 1; overflow-y: auto; margin-bottom: 10px; display: flex; flex-direction: column; gap: 10px; font-size: 13px; }
        .cs-msg { padding: 8px 12px; border-radius: 8px; max-width: 85%; }
        .cs-msg.sys { background: var(--surface-variant); align-self: flex-start; }
        .cs-msg.me { background: var(--primary-bg); color: var(--primary); align-self: flex-end; }

        @media (max-width: 1024px) { .main-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
        <div class="logo">
            <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.29-.62L10.5 5.8c.19-.3.49-.8 1.07-.8h1l-1 7h3.5c.58 0 .57.32.29.62L11.5 20.2c-.19.3-.49.8-1.07.8z"/></svg>
            å¿«ä¼ å·Agentç‰ˆ
        </div>
        <div class="header-actions">
            <a href="https://kuaichuan.360kuai.com" target="_blank" class="btn-text">
                <svg class="icon" style="width:16px;height:16px;margin-right:4px;" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                è¿”å›æ—§ç‰ˆ
            </a>
            <div class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
                <svg class="icon" id="themeIcon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
            </div>
            <div style="width: 32px; height: 32px; background: #ccc; border-radius: 50%; overflow: hidden;">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" width="32">
            </div>
        </div>
    </header>

    <!-- ä¸»å¸ƒå±€ -->
    <div class="main-layout">

        <!-- 1. æ¯æ—¥æ’­æŠ¥ Agent -->
        <div class="agent-card">
            <div class="agent-header">
                <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                æ¯æ—¥æ’­æŠ¥ Agent
                <span class="help-icon" data-tip="æ¯æ—¥8:00æ›´æ–°æ˜¨æ—¥æ•°æ®ä¸AIå»ºè®®">?</span>
            </div>
            <div class="agent-body">
                <!-- åŸºç¡€æ•°æ® -->
                <div class="metric-row">
                    <div class="metric-box">
                        <div class="metric-val">12.5k</div>
                        <div class="metric-lbl">é˜…è¯»é‡</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val">+892</div>
                        <div class="metric-lbl">ç²‰ä¸</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val">Â¥320</div>
                        <div class="metric-lbl">æ”¶ç›Š</div>
                    </div>
                </div>

                <!-- å®¡æ ¸å»ºè®® (æ–°å¢) -->
                <div class="audit-box">
                    <div class="audit-title">
                        <svg class="icon" style="width:16px;height:16px;" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        å†…å®¹å®¡æ ¸å»ºè®®
                        <span class="help-icon" data-tip="AIæ£€æµ‹åˆ°çš„æ½œåœ¨è¿è§„é£é™©">?</span>
                    </div>
                    <div class="audit-content">
                        æ‚¨æ˜¨æ—¥å‘å¸ƒçš„è§†é¢‘ã€Šç§‘æŠ€é»‘å¹•ã€‹ç–‘ä¼¼åŒ…å«å¤¸å¤§å®£ä¼ è¯æ±‡ï¼Œå»ºè®®ä¿®æ”¹æ ‡é¢˜ï¼Œé¿å…è¢«é™æµã€‚
                    </div>
                </div>

                <!-- æƒ…æŠ¥æ¨è (æ–°å¢) -->
                <div class="rec-list">
                    <div style="font-size:12px; font-weight:600; color:var(--text-secondary);">æƒ…æŠ¥æ¨è</div>
                    <div class="rec-item">
                        <span class="rec-tag tag-notice">å…¬å‘Š</span>
                        <div class="rec-text">å¿«ä¼ å·å…³äºæ‰“å‡»ä½è´¨å†…å®¹çš„æœ€æ–°è§„èŒƒ</div>
                    </div>
                    <div class="rec-item">
                        <span class="rec-tag tag-course">è¯¾ç¨‹</span>
                        <div class="rec-text">æ–°æ‰‹å¿…çœ‹ï¼šå¦‚ä½•å†™å‡º10w+çˆ†æ¬¾æ ‡é¢˜</div>
                    </div>
                    <div class="rec-item">
                        <span class="rec-tag tag-activity">æ´»åŠ¨</span>
                        <div class="rec-text">å‚ä¸â€œå¤æ—¥VlogæŒ‘æˆ˜â€ï¼Œç“œåˆ†ç™¾ä¸‡æµé‡</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. å†…å®¹åˆ›ä½œ Agent (å…¨æµç¨‹æ¨¡æ‹Ÿ) -->
        <div class="agent-card">
            <div class="agent-header">
                <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                å†…å®¹åˆ›ä½œ Agent
                <span class="help-icon" data-tip="AIè¾…åŠ©ç”Ÿæˆå›¾æ–‡æˆ–è§†é¢‘ï¼Œæ”¯æŒä¸€é”®å‘å¸ƒ">?</span>
            </div>
            <div class="agent-body" style="padding: 0;">
                
                <!-- å¼•å¯¼é¡µ -->
                <div class="guide-view" id="guideView" style="padding: 20px;">
                    <div style="text-align:center; margin-bottom:20px;">
                        <h3 style="margin-bottom:8px;">ä»Šå¤©æƒ³åˆ›ä½œä»€ä¹ˆï¼Ÿ</h3>
                        <p style="font-size:13px; color:var(--text-secondary);">é€‰æ‹©ä½“è£ï¼ŒAI å¸®æ‚¨ä»çµæ„Ÿåˆ°å‘å¸ƒ</p>
                    </div>
                    <div class="type-grid">
                        <div class="type-card" onclick="startFlow('article')">
                            <svg class="icon" style="width:40px;height:40px;color:var(--primary);margin-bottom:10px;" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                            <div style="font-weight:600;">å›¾æ–‡åˆ›ä½œ</div>
                            <div style="font-size:12px; color:var(--text-secondary); margin-top:4px;">æ–‡ç« ã€èµ„è®¯</div>
                        </div>
                        <div class="type-card" onclick="startFlow('video')">
                            <svg class="icon" style="width:40px;height:40px;color:var(--primary);margin-bottom:10px;" viewBox="0 0 24 24"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/></svg>
                            <div style="font-weight:600;">è§†é¢‘åˆ›ä½œ</div>
                            <div style="font-size:12px; color:var(--text-secondary); margin-top:4px;">çŸ­è§†é¢‘ã€æ··å‰ª</div>
                        </div>
                    </div>
                </div>

                <!-- èŠå¤©å·¥ä½œåŒº -->
                <div class="chat-view" id="chatView">
                    <div class="chat-box" id="chatBox">
                        <!-- æ¶ˆæ¯åŠ¨æ€æ’å…¥ -->
                    </div>
                    <div class="input-bar">
                        <button onclick="resetCreator()" style="border:none; background:transparent; color:var(--text-secondary); cursor:pointer;" title="è¿”å›">
                            <svg class="icon" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                        </button>
                        <input type="text" class="main-input" id="creatorInput" placeholder="è¾“å…¥ä¸»é¢˜..." onkeypress="handleEnter(event)">
                        <button class="send-btn" onclick="sendTopic()">
                            <svg class="icon" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                        </button>
                    </div>
                </div>

            </div>
        </div>

        <!-- å³ä¾§æ  -->
        <div style="display: flex; flex-direction: column; gap: 20px;">
            
            <!-- 3. è®¤è¯/è´¦å· (å˜å½¢æ¨¡å—) -->
            <div class="agent-card" id="authCard">
                <!-- çŠ¶æ€A: è®¤è¯åŠ©æ‰‹ -->
                <div class="agent-header" id="authHeader">
                    <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg>
                    è®¤è¯åŠ©æ‰‹ Agent
                    <span class="help-icon" data-tip="ä¸Šä¼ ææ–™å®Œæˆå®åè®¤è¯ï¼Œè§£é”æ›´å¤šæƒç›Š">?</span>
                </div>
                <div class="agent-body" id="authBody">
                    <div class="auth-view">
                        <div style="font-size:14px;">è¯·ä¸Šä¼ èº«ä»½è¯åŠèµ„è´¨è¯æ˜</div>
                        <div class="upload-box" onclick="uploadMaterial()">
                            <svg class="icon" style="width:32px;height:32px;margin-bottom:8px;" viewBox="0 0 24 24"><path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/></svg>
                            <div id="uploadText">ç‚¹å‡»ä¸Šä¼ ææ–™</div>
                        </div>
                        <div style="font-size:12px; color:var(--text-tertiary);">æ”¯æŒ JPG, PNG, PDF</div>
                    </div>
                </div>

                <!-- çŠ¶æ€B: è´¦å·ä¸­å¿ƒ (è®¤è¯åæ˜¾ç¤ºï¼Œæ— Agentæ ‡é¢˜) -->
                <div class="agent-body" id="accountBody" style="display: none;">
                    <div class="profile-card">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="profile-img">
                        <div>
                            <div style="font-weight:600; font-size:16px;">ç§‘æŠ€è§‚å¯Ÿè€…</div>
                            <div style="font-size:12px; color:var(--success); background:rgba(30,142,62,0.1); padding:2px 6px; border-radius:4px; display:inline-block; margin-top:4px;">å·²å®åè®¤è¯</div>
                        </div>
                    </div>
                    
                    <!-- è´¦å·å¥åº·åº¦ (ä»å·¦ä¾§ç§»æ¥) -->
                    <div class="health-score-box">
                        <div>
                            <div class="score-val">98</div>
                            <div style="font-size:12px; color:var(--text-secondary);">å¥åº·åˆ†</div>
                        </div>
                        <div>
                            <div class="score-val" style="color:var(--primary);">LV.5</div>
                            <div style="font-size:12px; color:var(--text-secondary);">ç­‰çº§</div>
                        </div>
                    </div>
                    <div style="font-size:12px; color:var(--text-secondary); line-height:1.4;">
                        è´¦å·çŠ¶æ€è‰¯å¥½ï¼Œå·²è·å¾—â€œä¼˜è´¨åˆ›ä½œè€…â€æµé‡æ‰¶æŒã€‚
                    </div>
                </div>
            </div>

            <!-- 4. å®¢æœåŠ©æ‰‹ Agent -->
            <div class="agent-card" style="flex: 1;">
                <div class="agent-header">
                    <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M21 12.22C21 6.73 16.96 3 12 3 7.03 3 3 6.73 3 12.22c0 5.07 3.57 8.64 8 9.65v-2.1c-3.13-.93-5-3.66-5-6.77 0-3.87 3.13-7 7-7s7 3.13 7 7c0 3.11-1.87 5.84-5 6.77v2.1c4.43-1.01 8-4.58 8-9.65zM12 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm1 4h-2v4h2v-4z"/></svg>
                    å®¢æœåŠ©æ‰‹ Agent
                    <span class="help-icon" data-tip="7x24å°æ—¶æ™ºèƒ½é—®ç­”ï¼Œè§£å†³å¹³å°ä½¿ç”¨é—®é¢˜">?</span>
                </div>
                <div class="agent-body">
                    <div class="preset-tags">
                        <div class="tag-chip" onclick="askPreset('å¦‚ä½•æç°ï¼Ÿ')">å¦‚ä½•æç°</div>
                        <div class="tag-chip" onclick="askPreset('å®¡æ ¸è§„èŒƒ')">å®¡æ ¸è§„èŒƒ</div>
                        <div class="tag-chip" onclick="askPreset('æµé‡æœºåˆ¶')">æµé‡æœºåˆ¶</div>
                    </div>
                    <div class="cs-chat-box" id="csChat">
                        <div class="cs-msg sys">æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ™ºèƒ½å®¢æœã€‚è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <input type="text" id="csInput" style="flex:1; padding:8px; border-radius:8px; border:1px solid var(--outline); background:var(--bg-card); color:var(--text-primary);" placeholder="è¾“å…¥é—®é¢˜...">
                        <button onclick="sendCs()" style="border:none; background:transparent; color:var(--primary); cursor:pointer;">
                            <svg class="icon" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- 1. ä¸»é¢˜åˆ‡æ¢ ---
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            html.setAttribute('data-theme', current === 'light' ? 'dark' : 'light');
        }

        // --- 2. åˆ›ä½œå…¨æµç¨‹æ¨¡æ‹Ÿ ---
        let currentType = '';

        function startFlow(type) {
            currentType = type;
            document.getElementById('guideView').style.display = 'none';
            document.getElementById('chatView').style.display = 'flex';
            
            const chat = document.getElementById('chatBox');
            chat.innerHTML = `
                <div class="msg ai">
                    <div class="avatar"><svg class="icon" viewBox="0 0 24 24"><path d="M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"/></svg></div>
                    <div class="bubble">å·²è¿›å…¥${type === 'article' ? 'å›¾æ–‡' : 'è§†é¢‘'}åˆ›ä½œæ¨¡å¼ã€‚è¯·è¾“å…¥æ‚¨çš„åˆ›ä½œä¸»é¢˜ï¼š</div>
                </div>
            `;
        }

        function resetCreator() {
            document.getElementById('chatView').style.display = 'none';
            document.getElementById('guideView').style.display = 'flex';
        }

        function handleEnter(e) {
            if(e.key === 'Enter') sendTopic();
        }

        function sendTopic() {
            const input = document.getElementById('creatorInput');
            const val = input.value.trim();
            if(!val) return;

            const chat = document.getElementById('chatBox');
            chat.innerHTML += `<div class="msg user"><div class="bubble">${val}</div></div>`;
            input.value = '';
            chat.scrollTop = chat.scrollHeight;

            // æ¨¡æ‹Ÿ AI æ€è€ƒä¸ç”Ÿæˆ
            setTimeout(() => {
                chat.innerHTML += `
                    <div class="msg ai">
                        <div class="avatar"><svg class="icon" viewBox="0 0 24 24"><path d="M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"/></svg></div>
                        <div class="bubble">æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆ${currentType === 'article' ? 'å¤§çº²' : 'è„šæœ¬'}...</div>
                    </div>
                `;
                chat.scrollTop = chat.scrollHeight;

                setTimeout(() => {
                    const resultHtml = currentType === 'article' 
                        ? `<div class="result-card">
                             <div class="result-preview"><svg class="icon" style="width:40px;height:40px;" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg></div>
                             <div class="result-info">
                               <div class="result-title">${val} - æ·±åº¦è§£æ</div>
                               <div style="font-size:12px;color:var(--text-secondary);">å·²ç”Ÿæˆ 1500 å­—ï¼ŒåŒ…å« 3 å¼ é…å›¾ã€‚</div>
                               <button class="publish-btn" onclick="publishContent(this)">ä¸€é”®å‘å¸ƒ</button>
                             </div>
                           </div>`
                        : `<div class="result-card">
                             <div class="result-preview"><svg class="icon" style="width:40px;height:40px;" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/></svg></div>
                             <div class="result-info">
                               <div class="result-title">${val} - çŸ­è§†é¢‘</div>
                               <div style="font-size:12px;color:var(--text-secondary);">æ—¶é•¿ 00:45ï¼Œæ•°å­—äººæ’­æŠ¥å·²å°±ç»ªã€‚</div>
                               <button class="publish-btn" onclick="publishContent(this)">ä¸€é”®å‘å¸ƒ</button>
                             </div>
                           </div>`;

                    chat.innerHTML += `
                        <div class="msg ai">
                            <div class="avatar"><svg class="icon" viewBox="0 0 24 24"><path d="M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"/></svg></div>
                            <div class="bubble" style="width:100%;">
                                å†…å®¹å·²ç”Ÿæˆï¼Œè¯·ç¡®è®¤ï¼š<br>
                                ${resultHtml}
                            </div>
                        </div>
                    `;
                    chat.scrollTop = chat.scrollHeight;
                }, 1500);
            }, 1000);
        }

        function publishContent(btn) {
            btn.innerText = "å‘å¸ƒä¸­...";
            btn.disabled = true;
            setTimeout(() => {
                btn.innerText = "å‘å¸ƒæˆåŠŸï¼";
                btn.style.background = "var(--success)";
                
                const chat = document.getElementById('chatBox');
                chat.innerHTML += `
                    <div class="msg ai">
                        <div class="avatar"><svg class="icon" viewBox="0 0 24 24"><path d="M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4 6.5 9.5 1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"/></svg></div>
                        <div class="bubble">ğŸ‰ æ­å–œï¼æ‚¨çš„å†…å®¹å·²æˆåŠŸå‘å¸ƒï¼Œæ­£åœ¨è¿›å…¥æ¨èæ± ã€‚</div>
                    </div>
                `;
                chat.scrollTop = chat.scrollHeight;
            }, 1500);
        }

        // --- 3. è®¤è¯ -> è´¦å·å˜å½¢é€»è¾‘ ---
        function uploadMaterial() {
            const txt = document.getElementById('uploadText');
            txt.innerText = "æ­£åœ¨ä¸Šä¼ å¹¶è¯†åˆ«...";
            
            setTimeout(() => {
                txt.innerText = "è¯†åˆ«æˆåŠŸï¼Œæäº¤å®¡æ ¸...";
                setTimeout(() => {
                    // éšè—è®¤è¯ç•Œé¢ï¼Œæ˜¾ç¤ºè´¦å·ç•Œé¢
                    document.getElementById('authHeader').style.display = 'none'; // éšè—æ ‡é¢˜
                    document.getElementById('authBody').style.display = 'none';
                    document.getElementById('accountBody').style.display = 'flex';
                }, 1500);
            }, 1500);
        }

        // --- 4. å®¢æœé€»è¾‘ ---
        function askPreset(q) {
            document.getElementById('csInput').value = q;
            sendCs();
        }

        function sendCs() {
            const input = document.getElementById('csInput');
            const val = input.value.trim();
            if(!val) return;

            const chat = document.getElementById('csChat');
            chat.innerHTML += `<div class="cs-msg me">${val}</div>`;
            input.value = '';
            chat.scrollTop = chat.scrollHeight;

            setTimeout(() => {
                chat.innerHTML += `<div class="cs-msg sys">æ”¶åˆ°ï¼ŒAgentæ­£åœ¨ä¸ºæ‚¨æŸ¥è¯¢ç›¸å…³ä¿¡æ¯...</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 800);
        }
    </script>
</body>
</html>
