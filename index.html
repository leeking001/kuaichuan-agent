<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¿«ä¼ å·Agentç‰ˆ</title>
    <style>
        /* --- 1. æ ¸å¿ƒå˜é‡ --- */
        :root {
            --bg-app: #F0F4F9;
            --bg-card: #FFFFFF;
            --text-primary: #1F1F1F;
            --text-secondary: #444746;
            --text-tertiary: #76777A;
            --primary: #0B57D0;
            --primary-bg: #D3E3FD;
            --outline: #E0E3E1;
            --surface-variant: #F0F4F9;
            --ai-highlight: #F2F8FF;
            --ai-text: #0B57D0;
            --success: #1E8E3E;
            --header-height: 64px;
            --radius: 16px;
            --shadow: 0 2px 6px rgba(0,0,0,0.05);
        }

        [data-theme="dark"] {
            --bg-app: #131314;
            --bg-card: #1E1F20;
            --text-primary: #E3E3E3;
            --text-secondary: #C4C7C5;
            --text-tertiary: #8E918F;
            --primary: #A8C7FA;
            --primary-bg: #0842A0;
            --outline: #444746;
            --surface-variant: #282A2C;
            --ai-highlight: #1F2225;
            --ai-text: #A8C7FA;
            --success: #81C995;
            --shadow: 0 2px 6px rgba(0,0,0,0.4);
        }

        /* --- 2. å…¨å±€é‡ç½® --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-app);
            color: var(--text-primary);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background 0.3s, color 0.3s;
        }
        a { text-decoration: none; color: inherit; }
        .icon { width: 20px; height: 20px; fill: currentColor; vertical-align: middle; }

        /* --- 3. ä¿®å¤åçš„ Tooltip --- */
        .help-container { position: relative; display: inline-flex; align-items: center; }
        .help-icon {
            display: inline-flex; align-items: center; justify-content: center;
            width: 16px; height: 16px; border-radius: 50%;
            background: var(--outline); color: var(--text-secondary);
            font-size: 10px; cursor: help; margin-left: 6px;
        }
        .help-icon:hover + .tooltip-text {
            opacity: 1; visibility: visible; transform: translateY(0);
        }
        .tooltip-text {
            position: absolute; top: 100%; left: 50%; transform: translateX(-50%) translateY(5px);
            background: rgba(0,0,0,0.85); color: #fff; padding: 8px 12px;
            border-radius: 8px; font-size: 12px; line-height: 1.4;
            width: max-content; max-width: 220px; white-space: normal;
            z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.2s;
            pointer-events: none; margin-top: 8px; text-align: left; font-weight: normal;
        }

        /* --- 4. é¡¶éƒ¨å¯¼èˆª --- */
        .header {
            height: var(--header-height); background: var(--bg-card); border-bottom: 1px solid var(--outline);
            display: flex; align-items: center; justify-content: space-between; padding: 0 24px; flex-shrink: 0;
        }
        .logo { font-size: 18px; font-weight: 600; color: var(--text-primary); display: flex; align-items: center; gap: 10px; }
        .header-actions { display: flex; align-items: center; gap: 16px; }
        .btn-text { font-size: 14px; color: var(--text-secondary); padding: 6px 12px; border-radius: 8px; transition: background 0.2s; }
        .btn-text:hover { background: var(--surface-variant); color: var(--primary); }
        .theme-toggle { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--text-secondary); background: var(--surface-variant); }

        /* --- 5. ä¸»å¸ƒå±€ --- */
        .main-layout {
            flex: 1; padding: 20px;
            display: grid; grid-template-columns: 340px 1fr 320px; /* å·¦ä¾§ç¨å®½ä»¥å®¹çº³è¯¦ç»†åˆ†æ */
            gap: 20px; overflow-y: auto;
        }

        /* é€šç”¨å¡ç‰‡ */
        .agent-card {
            background: var(--bg-card); border-radius: var(--radius);
            border: 1px solid var(--outline); display: flex; flex-direction: column;
            overflow: hidden; box-shadow: var(--shadow);
        }
        .agent-header {
            padding: 16px 20px; border-bottom: 1px solid var(--outline);
            font-weight: 600; font-size: 15px; display: flex; align-items: center;
            background: var(--bg-card); z-index: 2;
        }
        .agent-body { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 16px; }

        /* --- æ¨¡å— 1: æ¯æ—¥æ’­æŠ¥ (ç®¡å®¶æ¨¡å¼) --- */
        .butler-greeting { font-size: 14px; color: var(--text-primary); margin-bottom: 10px; font-weight: 500; }
        
        .report-section { display: flex; flex-direction: column; gap: 16px; }
        .report-card {
            border: 1px solid var(--outline); border-radius: 12px; padding: 12px;
            background: var(--surface-variant);
        }
        .report-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .report-lbl { font-size: 13px; color: var(--text-secondary); }
        .report-val { font-size: 18px; font-weight: 700; }
        
        /* AI åˆ†ææ°”æ³¡ */
        .ai-bubble {
            background: var(--bg-card); border-radius: 8px; padding: 10px;
            font-size: 12px; color: var(--text-secondary); line-height: 1.5;
            border-left: 3px solid var(--primary); display: flex; gap: 8px;
        }
        .ai-face { font-size: 16px; flex-shrink: 0; }

        /* æ¨èåˆ—è¡¨ */
        .rec-list { display: flex; flex-direction: column; gap: 10px; border-top: 1px solid var(--outline); padding-top: 16px; }
        .rec-item { display: flex; gap: 10px; cursor: pointer; align-items: flex-start; }
        .rec-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; height: fit-content; white-space: nowrap; margin-top: 2px; }
        .tag-notice { background: #E3F2FD; color: #1565C0; }
        .tag-course { background: #F3E5F5; color: #7B1FA2; }
        .tag-activity { background: #E8F5E9; color: #2E7D32; }
        .rec-text { font-size: 13px; line-height: 1.4; color: var(--text-primary); }
        .rec-text:hover { color: var(--primary); text-decoration: underline; }

        /* --- æ¨¡å— 2: å†…å®¹åˆ›ä½œ (å…­æ­¥æµç¨‹) --- */
        .step-indicator {
            display: flex; justify-content: space-between; margin-bottom: 20px; padding: 0 10px;
        }
        .step-dot {
            width: 8px; height: 8px; border-radius: 50%; background: var(--outline);
            position: relative;
        }
        .step-dot.active { background: var(--primary); transform: scale(1.2); }
        .step-dot.done { background: var(--success); }

        .creation-stage { display: flex; flex-direction: column; height: 100%; animation: fadeIn 0.3s; }
        .stage-title { font-size: 16px; font-weight: 600; text-align: center; margin-bottom: 20px; }
        
        /* æ­¥éª¤é€šç”¨æ ·å¼ */
        .gui-input {
            width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--outline);
            background: var(--bg-card); color: var(--text-primary); font-size: 14px; outline: none; margin-bottom: 16px;
        }
        .gui-input:focus { border-color: var(--primary); }
        
        .ai-preview-box {
            flex: 1; background: var(--surface-variant); border-radius: 12px; padding: 16px;
            font-size: 14px; line-height: 1.6; overflow-y: auto; margin-bottom: 16px;
            border: 1px solid var(--outline); white-space: pre-wrap;
        }
        
        .action-btn {
            width: 100%; padding: 12px; border-radius: 24px; border: none;
            background: var(--primary); color: #fff; font-size: 14px; font-weight: 500; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .action-btn:hover { opacity: 0.9; }
        .action-btn.secondary { background: var(--surface-variant); color: var(--text-primary); margin-top: 10px; }

        /* --- æ¨¡å— 3: è®¤è¯/è´¦å· --- */
        .auth-view { text-align: center; padding: 20px 0; }
        .upload-box {
            border: 2px dashed var(--outline); border-radius: 12px; padding: 30px 20px;
            margin: 20px 0; cursor: pointer; color: var(--text-secondary);
        }
        .upload-box:hover { border-color: var(--primary); color: var(--primary); }
        
        .account-view { display: none; flex-direction: column; gap: 16px; height: 100%; }
        .profile-card { display: flex; align-items: center; gap: 16px; }
        .profile-img { width: 60px; height: 60px; border-radius: 50%; background: #ccc; }
        .health-score-box {
            background: var(--surface-variant); padding: 16px; border-radius: 12px;
            text-align: center; display: flex; justify-content: space-around;
        }
        .score-val { font-size: 24px; font-weight: 700; color: var(--success); }

        /* --- æ¨¡å— 4: å®¢æœ (çƒ­æƒ…æ¨¡å¼) --- */
        .cs-chat-box { flex: 1; overflow-y: auto; margin-bottom: 10px; display: flex; flex-direction: column; gap: 12px; font-size: 13px; padding-right: 5px; }
        .cs-msg { padding: 10px 14px; border-radius: 12px; max-width: 85%; line-height: 1.4; }
        .cs-msg.sys { background: var(--surface-variant); align-self: flex-start; border-bottom-left-radius: 2px; }
        .cs-msg.me { background: var(--primary-bg); color: var(--primary); align-self: flex-end; border-bottom-right-radius: 2px; }
        
        .preset-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px; }
        .tag-chip { font-size: 12px; padding: 6px 12px; border-radius: 16px; background: var(--surface-variant); color: var(--text-secondary); cursor: pointer; }
        .tag-chip:hover { background: var(--primary-bg); color: var(--primary); }

        /* åŠ¨ç”» */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media (max-width: 1024px) { .main-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
        <div class="logo">
            <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.29-.62L10.5 5.8c.19-.3.49-.8 1.07-.8h1l-1 7h3.5c.58 0 .57.32.29.62L11.5 20.2c-.19.3-.49.8-1.07.8z"/></svg>
            å¿«ä¼ å·Agentç‰ˆ
        </div>
        <div class="header-actions">
            <a href="https://kuaichuan.360kuai.com" target="_blank" class="btn-text">
                <svg class="icon" style="width:16px;height:16px;margin-right:4px;" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                è¿”å›æ—§ç‰ˆ
            </a>
            <div class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
                <svg class="icon" id="themeIcon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
            </div>
            <div style="width: 32px; height: 32px; background: #ccc; border-radius: 50%; overflow: hidden;">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" width="32">
            </div>
        </div>
    </header>

    <!-- ä¸»å¸ƒå±€ -->
    <div class="main-layout">

        <!-- 1. æ¯æ—¥æ’­æŠ¥ Agent (ç®¡å®¶æ¨¡å¼) -->
        <div class="agent-card">
            <div class="agent-header">
                <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                æ¯æ—¥æ’­æŠ¥ Agent
                <div class="help-container">
                    <span class="help-icon">?</span>
                    <div class="tooltip-text">æ‚¨çš„ç§äººæ•°æ®ç®¡å®¶ï¼Œæ¯æ—¥8:00å‡†æ—¶æ±‡æŠ¥æ˜¨æ—¥æ•°æ®ï¼Œå¹¶æä¾›åŸºäºAIçš„è¿è¥å»ºè®®ã€‚</div>
                </div>
            </div>
            <div class="agent-body">
                <div class="butler-greeting">ğŸ‘‹ ä¸»äººï¼Œæ—©ä¸Šå¥½ï¼è¿™æ˜¯æ‚¨çš„æ˜¨æ—¥æˆ˜æŠ¥ï¼š</div>
                
                <div class="report-section">
                    <!-- å†…å®¹ç»´åº¦ -->
                    <div class="report-card">
                        <div class="report-top">
                            <span class="report-lbl">å†…å®¹è¡¨ç°</span>
                            <span class="report-val">12.5k <span style="font-size:12px;color:var(--success)">â–²12%</span></span>
                        </div>
                        <div class="ai-bubble">
                            <span class="ai-face">ğŸ¤–</span>
                            <div>ç§‘æŠ€ç±»æ–‡ç« å®Œæ’­ç‡æé«˜ã€‚<strong>æ³¨æ„ï¼š</strong>æ˜¨æ—¥è§†é¢‘ç–‘ä¼¼åŒ…å«å¤¸å¤§è¯æ±‡ï¼Œå»ºè®®ä¿®æ”¹æ ‡é¢˜ä»¥é˜²é™æµã€‚</div>
                        </div>
                    </div>

                    <!-- ç²‰ä¸ç»´åº¦ -->
                    <div class="report-card">
                        <div class="report-top">
                            <span class="report-lbl">ç²‰ä¸å¢é•¿</span>
                            <span class="report-val">+892 <span style="font-size:12px;color:var(--success)">â–²5%</span></span>
                        </div>
                        <div class="ai-bubble">
                            <span class="ai-face">ğŸ“ˆ</span>
                            <div>æ–°ç²‰å¤šæ¥è‡ªè§†é¢‘æµï¼Œå»ºè®®å‘å¸ƒä¸€æ¡å›¾æ–‡åŠ¨æ€ä¸æ–°ç²‰äº’åŠ¨ï¼Œæé«˜ç²˜æ€§ã€‚</div>
                        </div>
                    </div>

                    <!-- æ”¶ç›Šç»´åº¦ -->
                    <div class="report-card">
                        <div class="report-top">
                            <span class="report-lbl">æ˜¨æ—¥æ”¶ç›Š</span>
                            <span class="report-val">Â¥ 320.5</span>
                        </div>
                        <div class="ai-bubble">
                            <span class="ai-face">ğŸ’°</span>
                            <div>CPM ä¿æŒç¨³å®šï¼Œä¼˜è´¨åŸåˆ›è¡¥è´´å·²åˆ°è´¦ã€‚</div>
                        </div>
                    </div>
                </div>

                <!-- æ¨èåˆ—è¡¨ -->
                <div class="rec-list">
                    <div style="font-size:12px; font-weight:600; color:var(--text-secondary);">ç®¡å®¶æ¨è</div>
                    <div class="rec-item">
                        <span class="rec-tag tag-notice">å…¬å‘Š</span>
                        <div class="rec-text">å¿«ä¼ å·å…³äºæ‰“å‡»ä½è´¨å†…å®¹çš„æœ€æ–°è§„èŒƒ</div>
                    </div>
                    <div class="rec-item">
                        <span class="rec-tag tag-course">è¯¾ç¨‹</span>
                        <div class="rec-text">æ–°æ‰‹å¿…çœ‹ï¼šå¦‚ä½•å†™å‡º10w+çˆ†æ¬¾æ ‡é¢˜</div>
                    </div>
                    <div class="rec-item">
                        <span class="rec-tag tag-activity">æ´»åŠ¨</span>
                        <div class="rec-text">å‚ä¸â€œå¤æ—¥VlogæŒ‘æˆ˜â€ï¼Œç“œåˆ†ç™¾ä¸‡æµé‡</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. å†…å®¹åˆ›ä½œ Agent (å…­æ­¥æµç¨‹) -->
        <div class="agent-card">
            <div class="agent-header">
                <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                å†…å®¹åˆ›ä½œ Agent
                <div class="help-container">
                    <span class="help-icon">?</span>
                    <div class="tooltip-text">å…¨æµç¨‹AIè¾…åŠ©ï¼šé€‰é¢˜ -> å¤§çº² -> å…¨æ–‡ -> é…å›¾ -> é¢„è§ˆ -> å‘å¸ƒã€‚</div>
                </div>
            </div>
            <div class="agent-body" style="padding: 0;">
                
                <!-- é¡¶éƒ¨è¿›åº¦æ¡ -->
                <div style="padding: 20px 20px 0 20px;">
                    <div class="step-indicator">
                        <div class="step-dot active" id="dot1"></div>
                        <div class="step-dot" id="dot2"></div>
                        <div class="step-dot" id="dot3"></div>
                        <div class="step-dot" id="dot4"></div>
                        <div class="step-dot" id="dot5"></div>
                        <div class="step-dot" id="dot6"></div>
                    </div>
                </div>

                <!-- é˜¶æ®µ 1: é€‰é¢˜ -->
                <div id="stage1" class="creation-stage" style="padding: 20px;">
                    <div class="stage-title">ç¬¬ä¸€æ­¥ï¼šç¡®å®šé€‰é¢˜</div>
                    <input type="text" class="gui-input" id="topicInput" placeholder="è¾“å…¥æ‚¨çš„åˆ›ä½œçµæ„Ÿï¼Œä¾‹å¦‚ï¼š2024å¹´AIæ‰‹æœºå‘å±•è¶‹åŠ¿">
                    <button class="action-btn" onclick="nextStage(2)">ç”Ÿæˆå¤§çº²</button>
                </div>

                <!-- é˜¶æ®µ 2: å¤§çº² -->
                <div id="stage2" class="creation-stage" style="display: none; padding: 20px;">
                    <div class="stage-title">ç¬¬äºŒæ­¥ï¼šç¡®è®¤å¤§çº²</div>
                    <div class="ai-preview-box" id="outlineBox">AI æ­£åœ¨æ€è€ƒå¤§çº²æ¶æ„...</div>
                    <button class="action-btn" onclick="nextStage(3)">ç”Ÿæˆå…¨æ–‡</button>
                    <button class="action-btn secondary" onclick="prevStage(1)">ä¿®æ”¹é€‰é¢˜</button>
                </div>

                <!-- é˜¶æ®µ 3: å…¨æ–‡ -->
                <div id="stage3" class="creation-stage" style="display: none; padding: 20px;">
                    <div class="stage-title">ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆæ­£æ–‡</div>
                    <div class="ai-preview-box" id="contentBox">AI æ­£åœ¨æ’°å†™è¯¦ç»†å†…å®¹...</div>
                    <button class="action-btn" onclick="nextStage(4)">æ™ºèƒ½é…å›¾</button>
                    <button class="action-btn secondary" onclick="prevStage(2)">è°ƒæ•´å¤§çº²</button>
                </div>

                <!-- é˜¶æ®µ 4: é…å›¾ -->
                <div id="stage4" class="creation-stage" style="display: none; padding: 20px;">
                    <div class="stage-title">ç¬¬å››æ­¥ï¼šé…å›¾æˆå“</div>
                    <div class="ai-preview-box" id="imageBox">AI æ­£åœ¨åŒ¹é…é«˜æ¸…ç´ æ...</div>
                    <button class="action-btn" onclick="nextStage(5)">ç”Ÿæˆé¢„è§ˆ</button>
                    <button class="action-btn secondary" onclick="prevStage(3)">ä¿®æ”¹æ­£æ–‡</button>
                </div>

                <!-- é˜¶æ®µ 5: é¢„è§ˆ -->
                <div id="stage5" class="creation-stage" style="display: none; padding: 20px;">
                    <div class="stage-title">ç¬¬äº”æ­¥ï¼šæœ€ç»ˆé¢„è§ˆ</div>
                    <div class="ai-preview-box" id="finalPreview" style="background: #fff; border: 1px solid var(--primary);">
                        <!-- æœ€ç»ˆå†…å®¹å®¹å™¨ -->
                    </div>
                    <button class="action-btn" style="background: var(--success);" onclick="nextStage(6)">ç¡®è®¤å‘å¸ƒ</button>
                    <button class="action-btn secondary" onclick="prevStage(4)">é‡æ–°é…å›¾</button>
                </div>

                <!-- é˜¶æ®µ 6: å‘å¸ƒæˆåŠŸ -->
                <div id="stage6" class="creation-stage" style="display: none; padding: 40px; text-align: center; justify-content: center;">
                    <svg style="width: 64px; height: 64px; color: var(--success); margin: 0 auto 20px;" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/></svg>
                    <h3>å‘å¸ƒæˆåŠŸï¼</h3>
                    <p style="color: var(--text-secondary); margin-top: 10px;">æ‚¨çš„å†…å®¹å·²æäº¤å®¡æ ¸ï¼Œå³å°†åˆ†å‘è‡³æ¨èæµã€‚</p>
                    <button class="action-btn secondary" style="margin-top: 30px;" onclick="resetCreation()">å¼€å§‹æ–°çš„åˆ›ä½œ</button>
                </div>

            </div>
        </div>

        <!-- å³ä¾§æ  -->
        <div style="display: flex; flex-direction: column; gap: 20px;">
            
            <!-- 3. è®¤è¯/è´¦å· (å˜å½¢æ¨¡å—) -->
            <div class="agent-card" id="authCard">
                <!-- çŠ¶æ€A: è®¤è¯åŠ©æ‰‹ -->
                <div class="agent-header" id="authHeader">
                    <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg>
                    è®¤è¯åŠ©æ‰‹ Agent
                    <div class="help-container">
                        <span class="help-icon">?</span>
                        <div class="tooltip-text">ä¸Šä¼ èº«ä»½ææ–™ï¼Œå®Œæˆå®åè®¤è¯åå¯è§£é”æ”¶ç›Šæç°ã€æµé‡æ‰¶æŒç­‰é«˜çº§æƒç›Šã€‚</div>
                    </div>
                </div>
                <div class="agent-body" id="authBody">
                    <div class="auth-view">
                        <div style="font-size:14px;">è¯·ä¸Šä¼ èº«ä»½è¯åŠèµ„è´¨è¯æ˜</div>
                        <div class="upload-box" onclick="uploadMaterial()">
                            <svg class="icon" style="width:32px;height:32px;margin-bottom:8px;" viewBox="0 0 24 24"><path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/></svg>
                            <div id="uploadText">ç‚¹å‡»ä¸Šä¼ ææ–™</div>
                        </div>
                        <div style="font-size:12px; color:var(--text-tertiary);">æ”¯æŒ JPG, PNG, PDF</div>
                    </div>
                </div>

                <!-- çŠ¶æ€B: è´¦å·ä¸­å¿ƒ (è®¤è¯åæ˜¾ç¤ºï¼Œæ— Agentæ ‡é¢˜) -->
                <div class="agent-body" id="accountBody" style="display: none;">
                    <div class="profile-card">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="profile-img">
                        <div>
                            <div style="font-weight:600; font-size:16px;">ç§‘æŠ€è§‚å¯Ÿè€…</div>
                            <div style="font-size:12px; color:var(--success); background:rgba(30,142,62,0.1); padding:2px 6px; border-radius:4px; display:inline-block; margin-top:4px;">å·²å®åè®¤è¯</div>
                        </div>
                    </div>
                    
                    <!-- è´¦å·å¥åº·åº¦ (ä»å·¦ä¾§ç§»æ¥) -->
                    <div class="health-score-box">
                        <div>
                            <div class="score-val">98</div>
                            <div style="font-size:12px; color:var(--text-secondary);">å¥åº·åˆ†</div>
                        </div>
                        <div>
                            <div class="score-val" style="color:var(--primary);">LV.5</div>
                            <div style="font-size:12px; color:var(--text-secondary);">ç­‰çº§</div>
                        </div>
                    </div>
                    <div style="font-size:12px; color:var(--text-secondary); line-height:1.4;">
                        è´¦å·çŠ¶æ€è‰¯å¥½ï¼Œå·²è·å¾—â€œä¼˜è´¨åˆ›ä½œè€…â€æµé‡æ‰¶æŒã€‚
                    </div>
                </div>
            </div>

            <!-- 4. å®¢æœåŠ©æ‰‹ Agent (çƒ­æƒ…æ¨¡å¼) -->
            <div class="agent-card" style="flex: 1;">
                <div class="agent-header">
                    <svg class="icon" style="color: var(--primary);" viewBox="0 0 24 24"><path d="M21 12.22C21 6.73 16.96 3 12 3 7.03 3 3 6.73 3 12.22c0 5.07 3.57 8.64 8 9.65v-2.1c-3.13-.93-5-3.66-5-6.77 0-3.87 3.13-7 7-7s7 3.13 7 7c0 3.11-1.87 5.84-5 6.77v2.1c4.43-1.01 8-4.58 8-9.65zM12 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm1 4h-2v4h2v-4z"/></svg>
                    å®¢æœåŠ©æ‰‹ Agent
                    <div class="help-container">
                        <span class="help-icon">?</span>
                        <div class="tooltip-text">7x24å°æ—¶åœ¨çº¿ï¼Œä¸ºæ‚¨è§£ç­”å®¡æ ¸ã€æç°ã€æµé‡ç­‰å„ç±»é—®é¢˜ã€‚</div>
                    </div>
                </div>
                <div class="agent-body">
                    <div class="preset-tags">
                        <div class="tag-chip" onclick="askPreset('å¦‚ä½•æç°ï¼Ÿ')">å¦‚ä½•æç°</div>
                        <div class="tag-chip" onclick="askPreset('å®¡æ ¸è§„èŒƒ')">å®¡æ ¸è§„èŒƒ</div>
                        <div class="tag-chip" onclick="askPreset('æµé‡æœºåˆ¶')">æµé‡æœºåˆ¶</div>
                    </div>
                    <div class="cs-chat-box" id="csChat">
                        <!-- åˆå§‹æ¬¢è¿è¯­ç”± JS æ’å…¥ -->
                    </div>
                    <div style="display:flex; gap:8px;">
                        <input type="text" id="csInput" style="flex:1; padding:8px; border-radius:8px; border:1px solid var(--outline); background:var(--bg-card); color:var(--text-primary);" placeholder="è¾“å…¥é—®é¢˜...">
                        <button onclick="sendCs()" style="border:none; background:transparent; color:var(--primary); cursor:pointer;">
                            <svg class="icon" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- 1. ä¸»é¢˜åˆ‡æ¢ ---
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', next);
            
            const icon = document.getElementById('themeIcon');
            if(next === 'dark') {
                icon.innerHTML = '<path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.93c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0l-1.41 1.41c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.41-1.41zm13.42 13.42c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0l-1.41 1.41c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.41-1.41zM5.99 19.07c-.39-.39-1.02-.39-1.41 0l-1.41 1.41c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.41-1.41c.39-.39.39-1.02 0-1.41zM19.07 5.99c.39-.39.39-1.02 0-1.41l-1.41-1.41c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l1.41 1.41c.39.39 1.02.39 1.41 0z"/>';
            } else {
                icon.innerHTML = '<path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>';
            }
        }

        // --- 2. åˆ›ä½œ Agent (å…­æ­¥æµç¨‹é€»è¾‘) ---
        let currentStep = 1;
        let topic = "";

        function updateDots(step) {
            for(let i=1; i<=6; i++) {
                const dot = document.getElementById(`dot${i}`);
                dot.className = 'step-dot';
                if(i < step) dot.classList.add('done');
                if(i === step) dot.classList.add('active');
            }
        }

        function nextStage(step) {
            // éšè—æ‰€æœ‰
            for(let i=1; i<=6; i++) {
                document.getElementById(`stage${i}`).style.display = 'none';
            }
            
            // æ˜¾ç¤ºå½“å‰
            document.getElementById(`stage${step}`).style.display = 'flex';
            currentStep = step;
            updateDots(step);

            // é€»è¾‘å¤„ç†
            if(step === 2) {
                topic = document.getElementById('topicInput').value;
                if(!topic) { alert("è¯·è¾“å…¥ä¸»é¢˜"); prevStage(1); return; }
                document.getElementById('outlineBox').innerHTML = `AI æ­£åœ¨åŸºäºä¸»é¢˜â€œ${topic}â€æ„å»ºå¤§çº²...<br><br>1. å¼•è¨€ï¼šè¡Œä¸šèƒŒæ™¯åˆ†æ<br>2. æ ¸å¿ƒæŠ€æœ¯çªç ´ç‚¹<br>3. å¸‚åœºå½±å“ä¸é¢„æµ‹<br>4. æ€»ç»“`;
            }
            if(step === 3) {
                document.getElementById('contentBox').innerHTML = `AI æ­£åœ¨æ’°å†™æ­£æ–‡...<br><br>éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„é£é€Ÿå‘å±•ï¼Œ2024å¹´è¢«è§†ä¸ºAIæ‰‹æœºå…ƒå¹´ã€‚å„å¤§å‚å•†çº·çº·å¸ƒå±€... (å·²ç”Ÿæˆ 1200 å­—)`;
            }
            if(step === 4) {
                document.getElementById('imageBox').innerHTML = `AI æ­£åœ¨åˆ†ææ–‡æœ¬å¹¶åŒ¹é…å›¾ç‰‡...<br><br>âœ… åŒ¹é…å°é¢å›¾ (ç§‘æŠ€æ„Ÿ/è“è‰²è°ƒ)<br>âœ… åŒ¹é…æ’å›¾ 1 (æ•°æ®å›¾è¡¨)<br>âœ… åŒ¹é…æ’å›¾ 2 (äº§å“æ¸²æŸ“å›¾)`;
            }
            if(step === 5) {
                document.getElementById('finalPreview').innerHTML = `
                    <div style="width:100%; height:150px; background:#eee; display:flex; align-items:center; justify-content:center; color:#999; margin-bottom:10px;">[å°é¢å›¾é¢„è§ˆ]</div>
                    <h3 style="margin-bottom:10px;">${topic}</h3>
                    <p style="font-size:13px; color:#666;">è¿™é‡Œæ˜¯æœ€ç»ˆç”Ÿæˆçš„æ–‡ç« é¢„è§ˆå†…å®¹ã€‚æ’ç‰ˆå·²è‡ªåŠ¨ä¼˜åŒ–ï¼Œå›¾ç‰‡å·²æ’å…¥åˆé€‚ä½ç½®...</p>
                `;
            }
        }

        function prevStage(step) {
            nextStage(step);
        }

        function resetCreation() {
            document.getElementById('topicInput').value = '';
            nextStage(1);
        }

        // --- 3. è®¤è¯ -> è´¦å·å˜å½¢é€»è¾‘ ---
        function uploadMaterial() {
            const txt = document.getElementById('uploadText');
            txt.innerText = "æ­£åœ¨ä¸Šä¼ å¹¶è¯†åˆ«...";
            
            setTimeout(() => {
                txt.innerText = "è¯†åˆ«æˆåŠŸï¼Œæäº¤å®¡æ ¸...";
                setTimeout(() => {
                    document.getElementById('authHeader').style.display = 'none';
                    document.getElementById('authBody').style.display = 'none';
                    document.getElementById('accountBody').style.display = 'flex';
                }, 1500);
            }, 1500);
        }

        // --- 4. å®¢æœé€»è¾‘ (çƒ­æƒ…ä¸»åŠ¨) ---
        // åˆå§‹åŒ–æ¬¢è¿è¯­
        window.onload = function() {
            const chat = document.getElementById('csChat');
            chat.innerHTML = `<div class="cs-msg sys">ğŸ‘‹ å—¨ï¼æˆ‘æ˜¯æ‚¨çš„ä¸“å±å®¢æœåŠ©æ‰‹ï¼<br>æœ‰ä»€ä¹ˆåˆ›ä½œä¸Šçš„çƒ¦æ¼ï¼Œæˆ–è€…å¹³å°è§„åˆ™ä¸æ¸…æ¥šçš„ï¼Œéšæ—¶é—®æˆ‘å“¦ï¼âœ¨</div>`;
        }

        function askPreset(q) {
            document.getElementById('csInput').value = q;
            sendCs();
        }

        function sendCs() {
            const input = document.getElementById('csInput');
            const val = input.value.trim();
            if(!val) return;

            const chat = document.getElementById('csChat');
            chat.innerHTML += `<div class="cs-msg me">${val}</div>`;
            input.value = '';
            chat.scrollTop = chat.scrollHeight;

            setTimeout(() => {
                let reply = "æ”¶åˆ°ï¼è¿™å°±ä¸ºæ‚¨æŸ¥è¯¢ ğŸš€";
                if(val.includes("æç°")) reply = "ğŸ’° å…³äºæç°ï¼š<br>æ”¶ç›Šæ»¡ 100 å…ƒå³å¯åœ¨æ¯æœˆ 10-15 å·ç”³è¯·æç°å“¦ï¼";
                if(val.includes("å®¡æ ¸")) reply = "âš¡ï¸ å®¡æ ¸é€Ÿåº¦ï¼š<br>é€šå¸¸ 30 åˆ†é’Ÿå†…æå®šï¼å¦‚æœè¶…è¿‡ 2 å°æ—¶ï¼Œå¯ä»¥æŠŠæ ‡é¢˜å‘ç»™æˆ‘ï¼Œæˆ‘å¸®æ‚¨å‚¬å‚¬ï¼";
                
                chat.innerHTML += `<div class="cs-msg sys">${reply}</div>`;
                chat.scrollTop = chat.scrollHeight;
            }, 800);
        }
    </script>
</body>
</html>
